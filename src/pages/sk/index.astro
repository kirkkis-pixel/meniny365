---
import Layout from '../../layouts/Layout.astro';
import { getTodayString, formatDateSlovak } from '../../lib/date';
import { getNamesByDate } from '../../lib/meniny';
import { toSlug } from '../../lib/slug';

// Get today's date and names
const today = getTodayString();
const todayNames = await getNamesByDate(today);
const todayFormatted = formatDateSlovak(today);

// Generate structured data
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": `AI-Powered Name Days - ${todayFormatted}`,
  "description": `Dnes ${todayFormatted} maj칰 meniny: ${todayNames.join(', ')}. Prv칳 AI-powered kalend치r men칤n na Slovensku.`,
  "url": `https://meniny365.sk/sk`,
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": todayNames.map((name, index) => ({
      "@type": "ListItem",
      "position": index + 1,
      "name": name,
      "url": `https://meniny365.sk/sk/meno/${toSlug(name)}`
    }))
  }
};
---

<Layout 
  title={`AI-Powered Name Days - ${todayFormatted} | meniny365`}
  description={`Dnes ${todayFormatted} maj칰 meniny: ${todayNames.join(', ')}. Prv칳 AI-powered kalend치r men칤n na Slovensku s inteligentn칳m vyh쬬d치van칤m a n치vrhmi dar캜ekov.`}
  canonical="https://meniny365.sk/sk"
  structuredData={structuredData}
>
  <!-- Hero Section -->
  <section class="relative min-h-screen flex items-center justify-center overflow-hidden">
    <!-- Background Gradient -->
    <div class="absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50"></div>
    <div class="absolute inset-0 bg-gradient-to-tr from-transparent via-white/20 to-transparent"></div>
    
    <!-- Floating Elements -->
    <div class="absolute top-20 left-10 w-20 h-20 bg-gradient-to-r from-blue-400 to-purple-400 rounded-full opacity-20 animate-pulse"></div>
    <div class="absolute top-40 right-20 w-16 h-16 bg-gradient-to-r from-purple-400 to-pink-400 rounded-full opacity-20 animate-pulse" style="animation-delay: 1s;"></div>
    <div class="absolute bottom-20 left-1/4 w-12 h-12 bg-gradient-to-r from-indigo-400 to-blue-400 rounded-full opacity-20 animate-pulse" style="animation-delay: 2s;"></div>
    
    <div class="container relative z-10 text-center">
      <!-- AI Badge -->
      <div class="ai-badge mx-auto mb-8 animate-fade-in-up">
        <span>游뱄</span>
        <span>AI-Powered</span>
      </div>
      
      <!-- Main Heading -->
      <h1 class="text-display gradient-text mb-6 animate-fade-in-up" style="animation-delay: 0.2s;">
        Kto m치 dnes meniny?
      </h1>
      
      <!-- Date -->
      <p class="text-subtitle mb-12 animate-fade-in-up" style="animation-delay: 0.4s;">
        {todayFormatted}
      </p>
      
      <!-- Names Display -->
      {todayNames.length > 0 ? (
        <div class="animate-fade-in-up" style="animation-delay: 0.6s;">
          <h2 class="text-title mb-8">Dnes maj칰 meniny:</h2>
          <div class="flex flex-wrap justify-center gap-4 mb-12">
            {todayNames.map(name => (
              <a 
                href={`/sk/meno/${toSlug(name)}`}
                class="btn btn-primary text-lg px-8 py-4"
              >
                {name}
              </a>
            ))}
          </div>
        </div>
      ) : (
        <div class="animate-fade-in-up" style="animation-delay: 0.6s;">
          <p class="text-body text-xl">
            Dnes nem치 nikto meniny. Sk칰ste pozrie콘 in칳 de켿 v kalend치ri.
          </p>
        </div>
      )}
      
      <!-- Calendar View -->
      <div class="card p-8 max-w-4xl mx-auto animate-fade-in-up" style="animation-delay: 0.8s;">
        <h3 class="text-title mb-6">Kalend치r men칤n</h3>
        <div class="calendar-grid">
          <!-- Calendar will be populated by JavaScript -->
        </div>
      </div>
      
      <!-- CTA Buttons -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mt-12 animate-fade-in-up" style="animation-delay: 1s;">
        <a 
          href={`/api/ical?date=${today}`}
          class="btn btn-secondary"
          download={`meniny-${today}.ics`}
        >
          游늰 Prida콘 do kalend치ra
        </a>
        <a href="/sk/kalend치r" class="btn btn-ghost">
          Pozrie콘 cel칳 kalend치r
        </a>
      </div>
    </div>
  </section>

  <!-- Features Section -->
  <section class="py-20 bg-gradient-to-b from-transparent to-[var(--bg-secondary)]">
    <div class="container">
      <div class="text-center mb-16">
        <h2 class="text-headline mb-6">AI-Powered funkcie</h2>
        <p class="text-body text-xl max-w-3xl mx-auto">
          Prv칳 kalend치r men칤n na Slovensku s umelou inteligenciou. 
          Inteligentn칠 vyh쬬d치vanie, n치vrhy dar캜ekov a personalizovan칠 sk칰senosti.
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="card p-8 text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-6">
            <span class="text-2xl">游댌</span>
          </div>
          <h3 class="text-title mb-4">Inteligentn칠 vyh쬬d치vanie</h3>
          <p class="text-body">
            AI-powered vyh쬬d치vanie men칤n s n치vrhmi a podobnos콘ami. 
            N치jdite perfektn칠 meno pre va코e die콘a.
          </p>
        </div>
        
        <div class="card p-8 text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-6">
            <span class="text-2xl">游꾸</span>
          </div>
          <h3 class="text-title mb-4">N치vrhy dar캜ekov</h3>
          <p class="text-body">
            Personalizovan칠 n치vrhy dar캜ekov na z치klade mena a preferenci칤. 
            AI analyzuje trendy a navrhuje najlep코ie mo쬹osti.
          </p>
        </div>
        
        <div class="card p-8 text-center">
          <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-2xl flex items-center justify-center mx-auto mb-6">
            <span class="text-2xl">游늵</span>
          </div>
          <h3 class="text-title mb-4">Analytika men칤n</h3>
          <p class="text-body">
            맚atistiky popular칤t mien, trendy a predpovede. 
            Zistite, ktor칠 men치 s칰 najpopul치rnej코ie.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Actions -->
  <section class="py-20">
    <div class="container">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <a href="/sk/kalend치r" class="card p-6 text-center group hover:scale-105 transition-transform">
          <div class="text-4xl mb-4">游늰</div>
          <h3 class="text-xl font-semibold mb-2 group-hover:text-brand transition-colors">
            Kalend치r men칤n
          </h3>
          <p class="text-caption">Kompletn칳 kalend치r pre cel칳 rok</p>
        </a>
        
        <a href="/sk/popul치rne-men치" class="card p-6 text-center group hover:scale-105 transition-transform">
          <div class="text-4xl mb-4">游댠</div>
          <h3 class="text-xl font-semibold mb-2 group-hover:text-brand transition-colors">
            Popul치rne men치
          </h3>
          <p class="text-caption">Najpopul치rnej코ie men치 na Slovensku</p>
        </a>
        
        <a href="/sk/n치vrhy-mena" class="card p-6 text-center group hover:scale-105 transition-transform">
          <div class="text-4xl mb-4">游눠</div>
          <h3 class="text-xl font-semibold mb-2 group-hover:text-brand transition-colors">
            N치vrhy mien
          </h3>
          <p class="text-caption">AI-powered n치vrhy pre va코e die콘a</p>
        </a>
        
        <a href="/sk/blog" class="card p-6 text-center group hover:scale-105 transition-transform">
          <div class="text-4xl mb-4">游닇</div>
          <h3 class="text-xl font-semibold mb-2 group-hover:text-brand transition-colors">
            Blog
          </h3>
          <p class="text-caption">캛l치nky o men치ch a trad칤ci치ch</p>
        </a>
      </div>
    </div>
  </section>
</Layout>

<script>
  // Calendar functionality
  function generateCalendar() {
    const calendarGrid = document.querySelector('.calendar-grid');
    if (!calendarGrid) return;
    
    const today = new Date();
    const currentMonth = today.getMonth();
    const currentYear = today.getFullYear();
    
    // Get first day of month and number of days
    const firstDay = new Date(currentYear, currentMonth, 1);
    const lastDay = new Date(currentYear, currentMonth + 1, 0);
    const daysInMonth = lastDay.getDate();
    const startingDay = firstDay.getDay();
    
    // Month names in Slovak
    const monthNames = [
      'Janu치r', 'Febru치r', 'Marec', 'Apr칤l', 'M치j', 'J칰n',
      'J칰l', 'August', 'September', 'Okt칩ber', 'November', 'December'
    ];
    
    // Add month header
    const monthHeader = document.createElement('div');
    monthHeader.className = 'col-span-7 text-center text-lg font-semibold mb-4';
    monthHeader.textContent = `${monthNames[currentMonth]} ${currentYear}`;
    calendarGrid.parentNode.insertBefore(monthHeader, calendarGrid);
    
    // Add day headers
    const dayHeaders = ['Po', 'Ut', 'St', '맚', 'Pia', 'So', 'Ne'];
    dayHeaders.forEach(day => {
      const dayHeader = document.createElement('div');
      dayHeader.className = 'text-center text-sm font-medium text-text-tertiary py-2';
      dayHeader.textContent = day;
      calendarGrid.appendChild(dayHeader);
    });
    
    // Add empty cells for days before month starts
    for (let i = 0; i < startingDay; i++) {
      const emptyDay = document.createElement('div');
      emptyDay.className = 'calendar-day';
      calendarGrid.appendChild(emptyDay);
    }
    
    // Add days of month
    for (let day = 1; day <= daysInMonth; day++) {
      const dayElement = document.createElement('div');
      dayElement.className = 'calendar-day';
      dayElement.textContent = day;
      
      // Check if it's today
      if (day === today.getDate()) {
        dayElement.classList.add('today');
      }
      
      // Add click handler
      dayElement.addEventListener('click', () => {
        const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        window.location.href = `/sk/den/${currentYear}/${String(currentMonth + 1).padStart(2, '0')}/${String(day).padStart(2, '0')}`;
      });
      
      calendarGrid.appendChild(dayElement);
    }
  }
  
  // Initialize calendar when page loads
  document.addEventListener('DOMContentLoaded', generateCalendar);
</script>